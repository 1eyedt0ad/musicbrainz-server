<%args>
	$removerelease => undef
</%args>


<%perl>
	
	# Set up page
	$m->comp("/comp/sidebar-notitle", pagetitle => 'Collection');
	
	# Make sure user is logged on
	$m->comp("/comp/checkloggedin", 1, 1, "You need to be logged in to view your collection.", 1) or return;
	
	# Log on to database
	require MusicBrainz;
	my $mbro = $m->comp("/comp/dblogin");
	my $mbraw = MusicBrainz->new();
	$mbraw->Login(db => 'RAWDATA');
	
	# make sure the user has a collection_info tuple
	MusicBrainz::Server::CollectionInfo::AssureCollection($session{uid}, $mbraw->{DBH});
	
	# get the collection id
	my $collectionId = MusicBrainz::Server::CollectionInfo::GetCollectionIdForUser($session{uid}, $mbraw->{DBH});
</%perl>




<& /comp/collection, userId=>$session{uid}, dbh=>$mbro->{DBH}, rodbh=>$mbro->{DBH}, rawdbh=>$mbraw->{DBH}, collectionId=>$collectionId, removerelease=>$removerelease &>


<%perl>



</%perl>